<Window
    x:Class="AY.LearningTag.App.ControllSample.ListBox.ListBoxGroupSampleA"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:AY.LearningTag.App.ControllSample.ListBox"
    Title="ListBoxGroupSampleA"
    Width="800"
    Height="450"
    mc:Ignorable="d">

    <!--  如何同时多个列分组展示数据，以及分组的样式和模板设置  -->

    <Window.Resources>
        <!--  注册 Converter  -->
        <local:CategoryTitleGroupConverter x:Key="CategoryTitleGroupConverter" />

        <!--  定义 CollectionViewSource  -->
        <CollectionViewSource x:Key="ProductsViewSource" Source="{Binding Products}">
            <CollectionViewSource.GroupDescriptions>
                <!--  在进行分组时，将单列变成多列进行转换  -->
                <PropertyGroupDescription PropertyName="Category" Converter="{StaticResource CategoryTitleGroupConverter}" />

                <!--<PropertyGroupDescription PropertyName="GroupName"/>-->
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
    </Window.Resources>
    <Grid>
        <ListBox ItemsSource="{Binding Source={StaticResource ProductsViewSource}}">

            <ListBox.GroupStyle>
                <GroupStyle>
                    <!--<GroupStyle.ContainerStyle>
                <Style TargetType="GroupItem">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="GroupItem">
                                <StackPanel>
                                <TextBlock Text="{Binding Name}"/>
                                注意：这里表示每个分组的内容
                                 这里的ItemsPresenter表示每个分组下的所有子项
                                 也就是ListBoxItem
                                <ItemsPresenter />
                                </StackPanel>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </GroupStyle.ContainerStyle>-->
                    <GroupStyle.HeaderTemplate>
                        <DataTemplate>
                            <Border Margin="0,0,0,10" BorderThickness="0,0,0,1">
                                <Border.BorderBrush>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <GradientStop Offset="0" Color="#AFCFFE" />
                                        <GradientStop Offset="0.7" Color="#E2E8F0" />
                                        <GradientStop Offset="1" Color="#F4F6F7" />

                                    </LinearGradientBrush>
                                </Border.BorderBrush>
                                <StackPanel Margin="20" VerticalAlignment="Center" Orientation="Horizontal">
                                    <!--<Image Source="{Binding Name,Converter={StaticResource NameToImagePathConverter}}" Height="27" Width="27" Stretch="Uniform"/>-->
                                    <TextBlock Margin="10,0,0,0" VerticalAlignment="Center" Text="{Binding Name.Category}" />
                                    <TextBlock Text="{Binding Name.Title}" />
                                    <TextBlock Text="{Binding Items[0].Wy}"/>
                                </StackPanel>
                            </Border>

                        </DataTemplate>
                    </GroupStyle.HeaderTemplate>
                </GroupStyle>
            </ListBox.GroupStyle>

            <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <WrapPanel Margin="0,0,0,30" Background="Transparent" />
                </ItemsPanelTemplate>
            </ListBox.ItemsPanel>
            <ListBox.ItemContainerStyle>
                <Style TargetType="ListBoxItem">
                    <Setter Property="Background" Value="Transparent" />
                    <!--<Setter Property="Padding" Value="0" />
                    <Setter Property="Margin" Value="5" />-->
                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ListBoxItem">
                                <ContentPresenter />
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <!--<Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="Transparent" />
                </Trigger>
            </Style.Triggers>-->
                </Style>

            </ListBox.ItemContainerStyle>

            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Button
                        MinWidth="220"
                        Command="{Binding RelativeSource={RelativeSource AncestorType=ItemsControl}, Path=DataContext.ComandRpaActionChange}"
                        CommandParameter="{Binding}"
                        Content="{Binding Content}"
                        Cursor="Hand"
                        FontSize="14" />
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

    </Grid>
</Window>
